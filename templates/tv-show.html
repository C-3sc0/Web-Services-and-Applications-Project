<!DOCTYPE html>

<html lang="en">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<head>
    <meta charset="UTF-8">
    <link href="style.css" rel="stylesheet" />
    <title>TV Show Database</title>
</head>
<body>
    <h1 class="tmdb"> TV Show Database</h1>

    <header>
        <nav>
            <a href="#home" class="split" onclick="returnToHome()">Home</a>
            <a href="#about" onclick= "goToAbout()">About</a>
            <a href="#Movie database" onclick="goToMDB()"> Movie Database</a>
            <a href="#TV show database" onclick="goToTv()"> TV show Database</a>
            <a href="#Documentation">Documentation</a>
        </nav>
    </header>
    <main id="main"> </main>

    <footer>
        <p class = "Left">Author: Francesco Troja</p>
        <a href="https://github.com/C-3sc0" target="_blank">
        <i class="fa fa-github" style="font-size:50px"></i>
        </a>
    </footer> 

       <script>
        
        function returnToHome(){
            window.location.href = 'project.html';
        }
        function goToAbout(){
            window.location.href = 'about.html';
        }
        function goToMDB(){
            window.location.href = 'movie.html';
        }
        function goToTv(){
            window.location.href = 'tv-show.html';
        }

        const API_KEY = 'api_key=fa4eda4583d591db539b12271967147a';
        const BASE_URL = 'https://api.themoviedb.org/3';
        const API_URL = BASE_URL + '/trending/tv/week?language=en-US&'+API_KEY;
        const IMG_URL = 'https://image.tmdb.org/t/p/w500';

        const main = document.getElementById('main');

        getTvShow(API_URL)

        function getTvShow(url){
            fetch(url).then(res => {
                console.log(res.headers.get('Content-Type'));
                console.log(res.headers.get('Date'));
                 return res.json();
            }).then(data => {
                console.log(data.result);
                showTvShow(data.results);
            })
        }

        function showTvShow(data){
                main.innerHTML = '';
                data.forEach(tvShow => {
                    const{name,poster_path,vote_average,overview} = tvShow;
                    console.log(name, vote_average);                     
                    const tvShowEl = document.createElement("div");
                    tvShowEl.classList.add("movie");
                    tvShowEl.innerHTML = `
                        <img src="${IMG_URL+poster_path}" alt="${name}">
                        <div class= "movie-info">
                            <h3>${name}</h3>
                            <span class="${getColor(vote_average)}"> ${vote_average}</span>
                        </div>

                        <div class="overview">
                            <h3>overview</h3>
                            ${overview}
                        </div>                
                    `
                    main.appendChild(tvShowEl);
                })
        }

        function getColor(vote){
            if(vote>= 8){
                return 'green'
            }else if(vote >= 5){
                return "orange"
            }else{
                return 'red'
            }
        }
       </script>
</body>
</html>